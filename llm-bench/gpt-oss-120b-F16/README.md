# Benchmark Results
| backend                 | hipblaslt   | -fa   | -b     | pp512          | tg128        | max_mem   |
|-------------------------|-------------|-------|--------|----------------|--------------|-----------|
| llama.cpp-hip           |             |       |        | 349.57653      | 33.580682    | 62332     |
| llama.cpp-hip           | 1           |       |        | nan            | **33.66161** | 62963     |
| llama.cpp-hip           |             | -fa 1 |        | nan            | 33.021871    | 62086     |
| llama.cpp-hip           | 1           | -fa 1 |        | nan            | 33.016706    | 62116     |
| llama.cpp-rocwmma       |             |       |        | nan            | 33.338229    | 62199     |
| llama.cpp-rocwmma       | 1           |       |        | nan            | 33.343964    | 63455     |
| llama.cpp-rocwmma       |             | -fa 1 |        | nan            | 32.666084    | **62053** |
| llama.cpp-rocwmma       | 1           | -fa 1 |        | nan            | 32.572769    | 62085     |
| llama.cpp-vulkan_amdvlk |             |       |        | 428.472178     | 33.600083    | 64303     |
| llama.cpp-vulkan_amdvlk |             |       | -b 256 | 386.835679     | 33.623666    | 63831     |
| llama.cpp-vulkan_amdvlk |             | -fa 1 |        | **476.133065** | 33.242471    | 64143     |
| llama.cpp-vulkan_amdvlk |             | -fa 1 | -b 256 | 405.833015     | 33.244576    | 63778     |
## Performance Charts

### Tokens/s Performance
![PP Tokens/s](pp_tokens_per_sec.png)
![TG Tokens/s](tg_tokens_per_sec.png)

### Memory Usage
![PP VRAM](pp_vram_peak_mib.png)
![TG VRAM](tg_vram_peak_mib.png)

## Detailed Sweeps

### PP sweep
| backend                 | hipblaslt   | -fa   | -b     | 1             | 2             | 4             | 8             | 16           | 32             | 64             | 128            | 256            | 512            | 1024           |    2048 |    4096 |
|-------------------------|-------------|-------|--------|---------------|---------------|---------------|---------------|--------------|----------------|----------------|----------------|----------------|----------------|----------------|---------|---------|
| llama.cpp-hip           |             |       |        | 33.413708     | 39.302351     | 55.834519     | 63.466762     | 66.455436    | 107.581328     | **269.283019** | 293.390577     | 330.358749     | 349.57653      | 339.731228     | nan     | nan     |
| llama.cpp-hip           | 1           |       |        | **33.861094** | 39.289925     | 59.680689     | nan           | 61.81031     | 94.777603      | 233.427749     | **339.396212** | **472.862339** | nan            | nan            | 534.07  | nan     |
| llama.cpp-hip           |             | -fa 1 |        | 33.129274     | 38.247544     | 54.669823     | nan           | nan          | 94.043875      | nan            | nan            | nan            | nan            | nan            | nan     | nan     |
| llama.cpp-hip           | 1           | -fa 1 |        | 33.069765     | **39.328072** | 56.426876     | nan           | 65.094159    | 100.815122     | nan            | nan            | nan            | nan            | nan            | nan     | nan     |
| llama.cpp-rocwmma       |             |       |        | 31.93391      | 38.082745     | 57.045501     | 61.462331     | 62.124315    | 106.320872     | 263.474104     | 280.151751     | 326.276123     | nan            | nan            | nan     | nan     |
| llama.cpp-rocwmma       | 1           |       |        | 33.763132     | 38.781475     | **60.013724** | nan           | 59.278902    | 95.127856      | 224.967771     | 331.251826     | 464.390426     | nan            | nan            | nan     | 484.032 |
| llama.cpp-rocwmma       |             | -fa 1 |        | 32.832914     | 37.534864     | 57.49268      | 59.547448     | nan          | 96.023144      | nan            | nan            | nan            | nan            | nan            | nan     | nan     |
| llama.cpp-rocwmma       | 1           | -fa 1 |        | 32.753319     | 37.799481     | 57.808436     | **67.346393** | 61.548042    | 99.42683       | nan            | nan            | nan            | nan            | nan            | nan     | nan     |
| llama.cpp-vulkan_amdvlk |             |       |        | 33.338759     | 16.609975     | 23.362208     | 31.535017     | 78.695792    | 125.654694     | 207.996859     | 309.352625     | 393.258594     | 428.472178     | 422.873508     | 415.887 | 404.689 |
| llama.cpp-vulkan_amdvlk |             |       | -b 256 | 33.849735     | 16.620515     | 23.054123     | 31.505225     | **80.14365** | 127.206406     | 211.470014     | 308.932394     | 393.180364     | 386.835679     | 378.716545     | 372.69  | 352.164 |
| llama.cpp-vulkan_amdvlk |             | -fa 1 |        | 33.357625     | 16.582424     | 22.835655     | 31.578424     | 79.769362    | 126.5857       | 207.5747       | 304.376678     | 405.514799     | **476.133065** | **472.998673** | 466.726 | 447.505 |
| llama.cpp-vulkan_amdvlk |             | -fa 1 | -b 256 | 33.354823     | 16.593602     | 23.156295     | 30.438262     | 78.995205    | **127.362694** | 207.538646     | 306.65113      | 406.812597     | 405.833015     | 403.472496     | 397.935 | 382.506 |
### TG sweep
| backend                 | hipblaslt   | -fa   | -b     | 1             | 2             | 4             | 8             | 16            | 32            | 64            | 128          | 256           | 512           | 1024         | 2048          | 4096          |
|-------------------------|-------------|-------|--------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|--------------|---------------|---------------|--------------|---------------|---------------|
| llama.cpp-hip           |             |       |        | 33.915653     | 33.873955     | **33.882845** | 33.056968     | **33.884999** | 33.734238     | **33.851438** | 33.580682    | 33.342844     | 32.873097     | 32.148113    | 31.182359     | 29.872014     |
| llama.cpp-hip           | 1           |       |        | 33.883416     | **33.899217** | 33.882749     | **33.905856** | 33.846601     | **33.939372** | 33.827031     | **33.66161** | 33.336163     | 32.799501     | 32.160244    | 31.231511     | 29.88094      |
| llama.cpp-hip           |             | -fa 1 |        | 33.05654      | 33.086652     | 33.117936     | 32.486003     | 33.157097     | 32.854373     | 33.138727     | 33.021871    | 33.010427     | 32.267232     | 31.689837    | 30.823485     | nan           |
| llama.cpp-hip           | 1           | -fa 1 |        | 33.073439     | 33.131756     | 33.031318     | 33.141898     | 33.207966     | 33.05932      | 33.093892     | 33.016706    | 33.056693     | 32.282175     | 31.643798    | 30.766085     | 29.042691     |
| llama.cpp-rocwmma       |             |       |        | 33.688288     | 33.76455      | 33.794594     | 32.025919     | 32.470549     | 32.931133     | 33.286294     | 33.338229    | 33.193913     | 32.628363     | 31.79383     | 30.780796     | 29.278087     |
| llama.cpp-rocwmma       | 1           |       |        | 33.803333     | 33.717636     | 30.584545     | 31.524978     | 32.487811     | 32.984038     | 33.173377     | 33.343964    | 33.18592      | 32.653755     | 31.728417    | 30.752909     | 29.212711     |
| llama.cpp-rocwmma       |             | -fa 1 |        | 32.833693     | 32.832333     | 32.796612     | 31.175828     | 31.77611      | 32.185628     | 32.37876      | 32.666084    | 32.690688     | 31.878137     | 31.246987    | 30.251288     | 28.286826     |
| llama.cpp-rocwmma       | 1           | -fa 1 |        | 32.734078     | 32.731022     | 29.740663     | 31.131719     | 31.580707     | 32.054258     | 32.413237     | 32.572769    | 32.634016     | 31.834113     | 31.215277    | 30.202557     | 28.283418     |
| llama.cpp-vulkan_amdvlk |             |       |        | 33.490591     | 33.717861     | 33.495336     | 33.57242      | 33.441344     | 33.168024     | 33.659669     | 33.600083    | 33.481613     | 33.295021     | 33.039645    | 32.473629     | 31.867655     |
| llama.cpp-vulkan_amdvlk |             |       | -b 256 | **33.928303** | 33.841527     | 33.417009     | 33.610493     | 33.111631     | 33.79158      | 33.636879     | 33.623666    | **33.487536** | **33.343389** | **33.15064** | 32.600133     | 31.97277      |
| llama.cpp-vulkan_amdvlk |             | -fa 1 |        | 33.337551     | 33.086798     | 33.240432     | 32.936285     | 33.165768     | 32.796343     | 33.266718     | 33.242471    | 33.260844     | 33.210911     | 32.993092    | 32.73568      | 32.363731     |
| llama.cpp-vulkan_amdvlk |             | -fa 1 | -b 256 | 33.245375     | 33.264964     | 33.147684     | 32.891759     | 33.250771     | 33.221823     | 33.122257     | 33.244576    | 33.258141     | 33.225581     | 33.084838    | **32.879023** | **32.508365** |