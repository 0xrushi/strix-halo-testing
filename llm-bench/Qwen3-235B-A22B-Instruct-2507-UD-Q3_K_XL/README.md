# Benchmark Results
| backend          | hipblaslt   | -fa   | -b     |    pp512 | tg128         | max_mem    |
|------------------|-------------|-------|--------|----------|---------------|------------|
| llama.cpp-hip    |             |       |        | nan      | 12.727903     | 100561     |
| llama.cpp-hip    | 1           |       |        | 117.145  | 12.703545     | 101805     |
| llama.cpp-hip    |             | -fa 1 |        | nan      | 12.798923     | **100197** |
| llama.cpp-hip    | 1           | -fa 1 |        | nan      | 12.904985     | 100448     |
| llama.cpp-vulkan |             |       |        | 108.711  | 15.189258     | 101258     |
| llama.cpp-vulkan |             |       | -b 256 |  96.6151 | **15.202265** | 100984     |
| llama.cpp-vulkan |             | -fa 1 |        | 109.514  | 15.125167     | 100941     |
| llama.cpp-vulkan |             | -fa 1 | -b 256 |  95.1289 | 15.164707     | 100787     |
## Performance Charts

### Tokens/s Performance
![PP Tokens/s](pp_tokens_per_sec.png)
![TG Tokens/s](tg_tokens_per_sec.png)

### Memory Usage
![PP VRAM](pp_vram_peak_mib.png)
![TG VRAM](tg_vram_peak_mib.png)

## Detailed Sweeps

### PP sweep
| backend          | hipblaslt   | -fa   | -b     | 1                  | 2                      | 4                  |         8 | 16            | 32           | 64            |      128 |      256 |      512 |     1024 |     2048 |     4096 |
|------------------|-------------|-------|--------|--------------------|------------------------|--------------------|-----------|---------------|--------------|---------------|----------|----------|----------|----------|----------|----------|
| llama.cpp-hip    |             |       |        | 13.63057           | **11.755579000000001** | **9.416303**       | nan       | 8.61757       | 14.440774    | **45.510002** | nan      | nan      | nan      | nan      | nan      | nan      |
| llama.cpp-hip    | 1           |       |        | 13.742985000000001 | 9.157509               | nan                |   5.24667 | 8.349183      | 13.348146    | 43.437041     |  64.7946 | nan      | 117.145  | 112.553  | 104.592  | nan      |
| llama.cpp-hip    |             | -fa 1 |        | 13.593779          | nan                    | 7.751309           | nan       | 8.796772      | nan          | nan           | nan      | nan      | nan      | nan      | nan      | nan      |
| llama.cpp-hip    | 1           | -fa 1 |        | 13.653862          | 8.309497               | 8.731346           | nan       | 8.657596      | nan          | nan           | nan      | nan      | nan      | nan      | nan      | nan      |
| llama.cpp-vulkan |             |       |        | 15.458929          | 4.265724               | 5.790056           |   8.2844  | 16.124431     | 26.922118    | 42.910654     |  68.4555 |  95.7063 | 108.711  | 104.565  | 101.361  |  97.1546 |
| llama.cpp-vulkan |             |       | -b 256 | **15.86106**       | 4.265316               | 5.792894           |   8.28775 | **16.151322** | **26.93974** | 42.922599     |  68.4065 |  95.3671 |  96.6151 |  92.8007 |  90.7587 |  87.6519 |
| llama.cpp-vulkan |             | -fa 1 |        | 15.646974          | 4.211811               | 5.7453389999999995 |   8.2429  | 15.983527     | 26.598587    | 42.286681     |  67.2566 |  94.5073 | 109.514  | 106.726  | 102.206  |  92.1223 |
| llama.cpp-vulkan |             | -fa 1 | -b 256 | 15.611253          | 4.213698               | 5.748084           |   8.24238 | 15.949424     | 26.530762    | 42.448749     |  67.0136 |  94.4379 |  95.1289 |  93.5568 |  90.2533 |  82.1016 |
### TG sweep
| backend          | hipblaslt   | -fa   | -b     | 1                  | 2             | 4             | 8                  | 16            | 32            | 64            | 128           | 256           | 512           | 1024          | 2048          | 4096          |
|------------------|-------------|-------|--------|--------------------|---------------|---------------|--------------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|
| llama.cpp-hip    |             |       |        | 13.550669          | 11.555129     | 11.342999     | 11.267363          | 12.276287     | 12.596857     | 12.688311     | 12.727903     | 12.593415     | 12.213245     | 11.645482     | 10.770092     | 9.349837      |
| llama.cpp-hip    | 1           |       |        | 13.773364          | 13.822486     | 10.719001     | 11.017572          | 13.207548     | 12.862999     | 12.923422     | 12.703545     | 12.600227     | 12.234436     | 11.705637     | 10.801661     | 9.380591      |
| llama.cpp-hip    |             | -fa 1 |        | 13.672115999999999 | 11.470666     | 10.586682     | 11.242093          | 12.920578     | 12.605019     | 12.760716     | 12.798923     | 12.917628     | 12.835415     | 12.548766     | nan           | nan           |
| llama.cpp-hip    | 1           | -fa 1 |        | 6.638233           | 10.366058     | 10.035276     | 11.169731          | 12.214767     | 12.460746     | 12.770393     | 12.904985     | 12.968122     | 12.856306     | 12.596659     | 12.218604     | 11.539535     |
| llama.cpp-vulkan |             |       |        | 15.860278          | **15.786226** | 15.441655     | 15.592714          | **15.784252** | **15.879831** | 15.448517     | 15.189258     | **15.045966** | 14.78369      | 14.332989     | 13.450018     | 11.640821     |
| llama.cpp-vulkan |             |       | -b 256 | **15.887127**      | 15.718115     | **15.936851** | **15.77032**       | 15.613763     | 15.762119     | **15.482881** | **15.202265** | 15.032588     | **14.804708** | 14.285135     | 13.470788     | 11.568379     |
| llama.cpp-vulkan |             | -fa 1 |        | 15.613201          | 15.671965     | 15.166688     | 15.305503999999999 | 15.554179     | 15.566298     | 15.259894     | 15.125167     | 15.004484     | 14.802006     | **14.422227** | 13.656502     | **12.443644** |
| llama.cpp-vulkan |             | -fa 1 | -b 256 | 15.686592          | 15.351496     | 15.147308     | 15.428791          | 15.655159     | 15.553781     | 15.33934      | 15.164707     | 15.023946     | 14.803471     | 14.414458     | **13.668631** | 12.437799     |